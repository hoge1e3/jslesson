{"version":3,"sources":["/Tonyu/Projects/Turtle/Turtle.dtl"],"names":[],"mappings":"oCACgB;;;;;;mBAIQ;cACP,SAEe;MAC1B;cAKmC;oBAEtB;;;MAGV;MACM;MACT;aACA;;;;qBAG8B,kCACR,oCACR,8BACC;;gDAEE;;;CAClB,EAAE;eACU,gBAAwB,sBAOlC;;;CANE,GAAG,KAAc,QAAN;CACX,QAAQ,EAAI;CACZ,SAAS,EAAI;CAEb,EAAE;QACF,EAAE;KACa,YAAL,MAAiB;;;;iBAGnB,mBAAsB;YACyB;;;2CAG9C,KAAK;;;CAClB,KAAK,KAAkB;CACvB,KAAK,KAAkB;CACvB,UAAc,sBACA,WAAR,SAA2B,WAAR,SACX,WAAR,SAA2B,WAAR,SACgC,+EAC/B,qCAClB;QACR;;sDAEwB;;;CACxB;CACA,EAAI;;;;IACU,OAEZ;;aADiB,SAAZ;;QAEP;;2CAEa;;aAC2B;;6BAAP,MAAX,OAAO;;;0CAEjB,EAAE;;aAC4B;;4BAAP,MAAd,OAAO,IAAI;;;;;aAGb;;6CAEJ;;eACN;QAAI;;6CAEE;;iBACJ;QAAE;;8CAEG;;;CAChB,cAAkB,QAAN;;;QACX;IAAM,OAAmB;;QAAd,EAAQ,OAAL;;MACb;QACF;;;;;;;IAGY,OAAQ;;YAAiC;;;aAAV;;QAC3C;;;;;QAE0B;;0CACd;;CACZ,uBAAsB;cACV,SAEN,sDAAL;MACO,cAAL;QACH;;;;;CAGA;CACA,OAAI;CACJ,KAAI;cACwB,kBAAL,MACoB;MACzC;QACF","sourcesContent":["// system ! \"Actor\" use.\nturtle=Actor ! create.\nTurtle=turtle.\nturtle:initialize=[\n    width=32.height=32.\n    element= ! \"image\" createSVGElem.\n    element ! 0 get \n    \"http://www.w3.org/1999/xlink\" \"href\" \n    \"runtime/images/ayumi.gif\" setAttributeNS.\n    !adjustImage.\n    //element ! \"width\" (width+\"px\") attr\n    //\"height\" (height+\"px\") attr\n    //\"x\" (-width/2) attr\n    //\"y\" (-height/2) attr\n    element ! \"transform\" \"scale(1,-1)\" attr.\n    //(svg_g) appendTo.\n    pos=Vec2! 0 0 create.\n    dir=0.\n    isPenDown=true.\n    ! 3 lineWidth.\n    ! \"black\" lineColor.\n    !appear.\n    !newLineG.\n].\nturtle:adjustImage=[\n    element ! \"width\" (width+\"px\") attr\n    \"height\" (height+\"px\") attr\n    \"x\" (-width/2) attr\n    \"y\" (-height/2) attr.\n].\nturtle:getImageSize=[|url;t|\n    t=this.\n    $ ! \"<img>\" create \"display\" \"none\" css [|;j|\n        j=(t:$) ! (this) create.\n        t:width=j ! width.\n        t:height=j ! height.\n        //(t:console) ! \"getims\" (t:width) (t:height) log.\n        t!adjustImage.\n        j!remove.\n    ] load \"src\" (url) attr \"body\" appendTo.\n].\nturtle:newLineG=[\n    lineG=! \"g\" createSVGElem (svg_g) appendTo.\n    lineG ! \"transform\" (\"translate(\"+(pos:x)+\" \"+(pos:y)+\")\") attr.\n    lineOrig=pos.\n].\nturtle:addPath=[|pos1 pos2;line|// pos:world coord\n    pos1=pos1 ! (lineOrig) sub.\n    pos2=pos2 ! (lineOrig) sub.\n    line=! \"line\" createSVGElem\n    \"x1\" (pos1:x) attr \"y1\" (pos1:y) attr\n    \"x2\" (pos2:x) attr \"y2\" (pos2:y) attr \n    \"style\" (\"stroke:\"+_lineCol+\";stroke-width:\"+_lineWidth) attr\n    \"data-width\" (_lineWidth) attr\n    (lineG) appendTo.\n    this.\n].\nturtle:addPathAfterAction=[|a;pos1|\n    pos1=pos.\n    a ! execute.\n    [isPenDown] ! then [\n        ! (pos1) (pos) addPath.\n    ] execute.\n    this.\n].\nturtle:forward=[|by|\n    ! [(Actor:forward) ! (this) (by) call.] addPathAfterAction.\n].\nturtle:moveTo=[|x y|\n    ! [(Actor:moveTo) ! (this) (x) (y) call.] addPathAfterAction.\n].\nturtle:close=[\n    ! (pos) (lineOrig) addPath.\n].\nturtle:lineColor=[|col|\n    _lineCol=col.this.\n].\nturtle:lineWidth=[|w|\n    _lineWidth=w.this.\n].\nturtle:makeFigure=[|col;r|\n    r=Figure ! (this) create.\n    [col]! then[r!(col) paint]execute.\n    ! newLineG.\n    r.\n].\nturtle:penDown=[\n    [isPenDown]!then [] else [isPenDown=true. !newLineG] execute. \n    this\n].\nturtle:penUp=[isPenDown=false.this.].\nturtle:change=[|url|\n    url=\"runtime/images/\"+url.\n    element ! 0 get \n    \"http://www.w3.org/1999/xlink\" \"href\" \n    (url) setAttributeNS.\n    ! (url) getImageSize.\n    this.\n].\nturtle:setTrans=[|;str|\n    str=\"translate(\"+(pos:x)+\" \"+(pos:y)+\") \".\n    str=str+\"rotate(\"+dir+\") \".\n    str=str+\"scale(1 -1) \".\n    element ! \"transform\" (str) attr\n    \"data-trans\" ((pos:x)+\",\"+(pos:y)+\",\"+dir) attr.\n    ! checkCrash.\n    this.\n].\n"]}