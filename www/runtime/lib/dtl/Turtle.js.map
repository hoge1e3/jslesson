{"version":3,"sources":["/home/devel/devel/Turtle/Turtle.dtl"],"names":[],"mappings":"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","sourcesContent":["// system ! \"Actor\" use.\r\n//test3\r\nturtle=Actor ! create.\r\nTurtle=turtle.\r\nTurtle:baseURL=window:runtimePath+\"images/\".\r\nTurtle:img=\"ayumi.gif\".\r\nturtle:action=[/*:window!\"aa\"alert*/].\r\nturtle:initialize=[|;t|\r\n    t=this.//@hoge1e3\r\n    element= ! \"image\" createSVGElem.\r\n    element ! 0 get \r\n    \"http://www.w3.org/1999/xlink\" \"href\" \r\n    (baseURL+img) setAttributeNS.\r\n    !adjustImage.\r\n    ! (baseURL+img) getImageSize .\r\n    element ! \"transform\" \"scale(1,-1)\" attr.\r\n    element ! [t!action] click.//@hoge1e3\r\n    ! \"black\" lineColor.\r\n    !newLineG.\r\n    isShowing=false.\r\n    !appear.\r\n].\r\nturtle:width=32.\r\nturtle:height=32.\r\nturtle:_lineWidth=3.\r\nturtle:isPenDown=true.\r\n\r\nturtle:adjustImage=[\r\n    element ! \"width\" (width+\"px\") attr\r\n    \"height\" (height+\"px\") attr\r\n    \"x\" (-width/2) attr\r\n    \"y\" (-height/2) attr.\r\n].\r\nturtle:getImageSize=[|url;t|\r\n    t=this.\r\n    $ ! \"<img>\" create \"display\" \"none\" css [|;j|\r\n        j=(t:$) ! (this) create.\r\n        t:width=j ! width.\r\n        t:height=j ! height.\r\n        //(t:console) ! \"getims\" (t:width) (t:height) log.\r\n        t!adjustImage.\r\n        j!remove.\r\n    ] load \"src\" (url) attr \"body\" appendTo.\r\n].\r\nturtle:newLineG=[\r\n    lineG=! \"g\" createSVGElem (svg_g) appendTo.\r\n    lineG ! \"transform\" (\"translate(\"+(pos:x)+\" \"+(pos:y)+\")\") attr.\r\n    lineOrig=pos.\r\n].\r\nturtle:addPath=[|pos1 pos2;line|// pos:world coord\r\n    pos1=pos1 ! (lineOrig) sub.\r\n    pos2=pos2 ! (lineOrig) sub.\r\n    line=! \"line\" createSVGElem\r\n    \"x1\" (pos1:x) attr \"y1\" (pos1:y) attr\r\n    \"x2\" (pos2:x) attr \"y2\" (pos2:y) attr \r\n    \"style\" (\"stroke:\"+_lineCol+\";stroke-width:\"+_lineWidth) attr\r\n    \"data-width\" (_lineWidth) attr\r\n    (lineG) appendTo.\r\n    this.\r\n].\r\nturtle:addPathAfterAction=[|a;pos1|\r\n    pos1=pos.\r\n    a ! execute.\r\n    //console ! \"PEND\" (isPenDown) log.\r\n    //[[isShowing]![isPendown]or] ! then  // <-これだとペンなしが効かなくなるよー\r\n    [isPenDown] ! then [\r\n        ! (pos1) (pos) addPath.\r\n    ] execute.\r\n    this.\r\n].\r\nturtle:forward=[|by|\r\n    ! [(Actor:forward) ! (this) (by) call.] addPathAfterAction.\r\n].\r\nturtle:moveTo=[|x y|\r\n    ! [(Actor:moveTo) ! (this) (x) (y) call.] addPathAfterAction.\r\n].\r\nturtle:circle=[|r;d|\r\n    d=r * 0.1745328.\r\n    !(d/2)backward.\r\n    [!(d)forward 10 rightTurn] !36 repeat。\r\n    !(d/2)forward\r\n].\r\nturtle:closePath=[\r\n    [isPenDown]!then[\r\n        //! (pos) (lineOrig) addPath.\r\n        ! (lineOrig:x)(lineOrig:y)moveTo.\r\n    ]execute.\r\n    self.\r\n].\r\nturtle!\"closePath\" \"close\" addAlias.\r\nturtle:lineColor=[|col|\r\n    _lineCol=col.this.\r\n].\r\nturtle:lineWidth=[|w|\r\n    w=!(w)num.\r\n    _lineWidth=w.this.\r\n].\r\nturtle:makeFigure=[|col;r|\r\n    r=Figure ! (this) create.\r\n    [col]! then[r!(col) paint]execute.\r\n    ! newLineG.\r\n    r.\r\n].\r\nturtle:paint=[|col|\r\n    !(col) makeFigure.\r\n].\r\nturtle:penDown=[\r\n    [isPenDown]!then [] else [isPenDown=true. !newLineG] execute. \r\n    this\r\n].\r\nturtle:penUp=[isPenDown=false.this.].\r\nturtle:setShape=[|url|\r\n    self:img=url.\r\n    url=[url ! \"https?\" match] ! then [url] else [baseURL+url] execute.\r\n    element ! 0 get \r\n    \"http://www.w3.org/1999/xlink\" \"href\" \r\n    (url) setAttributeNS.\r\n    ! (url) getImageSize.\r\n    this.\r\n].\r\nturtle ! \"setShape\" \"change\" addAlias.\r\nturtle:setTrans=[|;str|\r\n    str=\"translate(\"+(pos:x)+\" \"+(pos:y)+\") \".\r\n    str=str+\"rotate(\"+dir+\") \".\r\n    str=str+\"scale(1 -1) \".\r\n    element ! \"transform\" (str) attr\r\n    \"data-trans\" ((pos:x)+\",\"+(pos:y)+\",\"+dir) attr.\r\n    [isShowing] ! then [ ! checkCrash ] execute.\r\n    this.\r\n].\r\n:action=[].\r\n:action:isEventHandler=true.\r\n:click=[].\r\n:click:isEventHandler=true.\r\nturtle:setAction=[|f|\r\n    [(!(f)typeof)==\"function\"]!then[\r\n        self:action=f.    \r\n    ]execute.\r\n    self.\r\n].\r\n"]}