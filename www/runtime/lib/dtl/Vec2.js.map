{"version":3,"sources":["/home/devel/devel/Turtle/Vec2.dtl"],"names":[],"mappings":"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","sourcesContent":["// Dolittle\r\nVec2=! create. \r\nVec2:initialize=[|x y|\r\n    this:x=x. this:y=y.\r\n].\r\nVec2:add=[|o|\r\n    Vec2! (x+o:x) (y+o:y) create.\r\n].\r\nVec2:sub=[|o|\r\n    Vec2! (x-o:x) (y-o:y) create.\r\n].\r\nVec2.mul=[|k|\r\n    Vec2! (k*x) (k*y) create.\r\n].\r\nVec2.div=[|k|\r\n    Vec2! (x/k) (y/k) create.\r\n].\r\nVec2:len=[\r\n    (window:Math) ! (x*x+y*y) sqrt.\r\n].\r\nVec2:dir=[\r\n    (window:Math) ! (y) (x) atan2 degree.\r\n].\r\nVec2:rotate=[|d;vx vy|\r\n    vx=Vec2 ! (d ! cos) (d ! sin) create.     \r\n    vy=Vec2 ! ((d+90) ! cos) ((d+90) ! sin) create.\r\n    vx ! (x) mul (vy ! (y) mul) add. \r\n].\r\nVec2:O=Vec2 ! 0 0 create.\r\nVec2:X=Vec2 ! 1 0 create.\r\nVec2:Y=Vec2 ! 0 1 create.\r\n\r\nShape=! create.\r\nShape:isIdentityTransform=[|dir pos| \r\n    [dir==0] ! [pos.x==0] [pos.y==0] and.\r\n].\r\nPolygon=Shape ! create.\r\nPolygon:initialize=[|v2ary|\r\n    this:v2ary=[v2ary] ! then [v2ary] else [ Array!create.] execute.\r\n].\r\nPolygon:fromPolyKArray=[|a;x y res|\r\n    res=Polygon ! create.\r\n    [a!length] ! while [\r\n        x=a! shift.\r\n        y=a! shift.\r\n        res ! (x) (y) addVertex.\r\n    ] execute.\r\n    res.\r\n].\r\n\r\nPolygon:originPoint=[\r\n    and ! [v2ary] [(v2ary! length?)>0] true then [\r\n        v2ary ! 1 get\r\n    ] execute.\r\n].\r\nPolygon:lastPoint=[\r\n    and ! [v2ary] [(v2ary! length?)>0] true then [\r\n        v2ary ! (v2ary! length?) get\r\n    ] execute.\r\n].\r\nPolygon:isPathClosed=[|;o l|\r\n    o=!originPoint.\r\n    l=!lastPoint.\r\n    and ! [o] [l] [(o ! (l) sub len)<0.1] true \r\n].\r\nPolygon:addVertex=[|x y|\r\n    v2ary! (Vec2 !(x) (y) create) push.\r\n    this.\r\n].\r\nPolygon:addPoint=Polygon:addVertex.\r\nPolygon:toPolyKArray=[|;res|\r\n    res=Array ! create.\r\n    v2ary ! [|e|\r\n        res ! (e:x) push.\r\n        res ! (e:y) push.\r\n    ] forEach.\r\n    [!isPathClosed] ! then [res ! pop. res ! pop] execute.\r\n    (window:PolyK) ! (res) FixDirection.\r\n].\r\nPolygon:transform=[|deg pos;res|\r\n    Polygon! (v2ary ! [|v|\r\n        v! (deg) rotate (pos) add.\r\n    ] map) create.\r\n].\r\nPolygon:each=[|f|\r\n    v2ary ! [|v|\r\n        f ! (v) execute.\r\n    ] forEach.\r\n].\r\nPolygon:pointCount=[\r\n    v2ary:length.\r\n].\r\nPolygon:center=[|;p|\r\n    p=Vec2:O.\r\n    ! [|v|\r\n        p = p ! (v) add.\r\n    ] each.\r\n    p ! (!pointCount) div.\r\n].\r\nPolygon:fromLine=[|pos1 pos2 width;p d l|\r\n    p=pos2!(pos1)sub.\r\n    d=p! dir.\r\n    l=p! len.\r\n    ! create \r\n    0 -(width/2) addPoint \r\n    (l) -(width/2) addPoint \r\n    (l) (width/2) addPoint\r\n    0 (width/2) addPoint (d) (pos1) transform .\r\n].\r\nPolygon:intersects= [|o|\r\n    [o ! (Polygon) is ] ! then [\r\n        (window:PolyK) ! (!toPolyKArray) (o!toPolyKArray) Intersects.\r\n    ] else [\r\n        o ! (this) intersects.\r\n    ] execute.\r\n].\r\nShapeGroup=Shape! create.\r\nShapeGroup:initialize=[\r\n    shapes=Array ! create.\r\n].\r\nShapeGroup:add=[|s|\r\n    shapes ! (s) push.\r\n].\r\nShapeGroup:intersects=[|b;res a|\r\n    a=this.\r\n    [b ! (ShapeGroup) is] ! then [\r\n        (a:shapes) ! [|ae|\r\n            (b:shapes) ! [|be|\r\n                [ae ! (be) intersects  ] !then[res=true] execute.\r\n            ] each.\r\n        ] each.\r\n    ] else [\r\n        (a:shapes) ! [|ae|\r\n            [ae ! (b) intersects] !then[res=true] execute.\r\n        ] each.\r\n    ] execute.\r\n    res\r\n].\r\nShapeGroup:transform=[|dir pos;res| \r\n    res= ShapeGroup ! create.\r\n    shapes ! [|s|\r\n        res ! (s ! (dir) (pos) transform) add.\r\n    ] forEach.\r\n    res.\r\n].\r\nShapeGroup:center=[|;p|\r\n    p=Vec2:O.\r\n    shapes ! [|s|\r\n        p = p ! (s!center) add.\r\n    ] each.\r\n    p ! (shapes:length) div.\r\n]."]}