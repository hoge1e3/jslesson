{"version":3,"sources":["/home/devel/devel/Turtle/Timer.dtl"],"names":[],"mappings":"8DACC;yBACA,gBAAS,SAAK;yBACd,gBAAS,SAHR;;kDAAA,IAIQ,iBAJP,sBAIc;;kDAJd,AAIgB;;yBAJjB;;yBAQD;yBACA,aAAM,MALgB;yBAMtB,aAAM,MANgB;yBAOtB,aAAM,aAXL,sBAWgB;;kDAXf;;mDAAD,AAYI,GAZJ;eAAC;;kDAAD,AAYe,EAZf;;yBAAA,IAaQ,OAbR,AAaU,EA4BJ;yBAzCN;;yBAgBD,aAAM,UAhBL,sBAgBa;;kDAhBb,IAgBoB,MAhBpB,AAgBsB;yBAhBtB;;yBAiBD,aAAM,aAjBL,sBAiBgB;;kDAjBhB,IAiBuB,QAjBvB,AAiByB,EAwBnB,QAzCN,IAiBqC;yBAjBrC;;yBAkBD,aAAM,MAAG,uBAAS,cAAO,KAAE;yBAC3B,aAAM,SAnBL;;;yBAoBD,aAAM,UApBL;;;yBAqBD;yBACA,aAAM,YAtBL,sBAsBe;;;;;;kDAtBf,AAuBG,EAvBH;yBAAA,AAwBG,EAxBH,AAwBK,CAAE;yBAxBP,AAyBG,EAzBH,AAyBK,CAAE;yBAzBP,AA0BG,EA1BH;yBA2BI,gBAAS,iBA3Bb,AA2BmB;yBA3BnB,AA4BG,CAAE,MA5BL,AA4BO,CAAE,cA5BR;;;kDAAD,AA6BO,CAAE,UA7BP;;kDA6Be,iCA7BjB,AA6ByB,CAAE;;yBA7B3B,AA8BO,CAAE,SA9BP;;kDA8Bc,iCA9BhB,AA8BwB,CAAE;yBA9BzB,AA8B0C;;yBA9B1C,AA+BM,EAAG,uBAAS,cAAO,KAAE;yBA/B5B,AAgCO,CAAE,QAAK,+BAhCZ;;kDAAC;;kDAAH,AAiCY,cAjCZ,AAiCe;2BAjCZ,sBAiC6B;;kDAjChC,AAkCe;yBACA,uCAnCZ,AAmCkC;;yBAnCrC,AAsCW,GAtCX,AAsCa,EAtCb;yBAAG;;mDAAH,AAuCY,EAvCZ,AAuCc;8BAvCX;;kDAAH,AAwCe;;UAxCf,AA0CU;yBA1CT,AA2CM;;yBA3CP;;yBA+CD,aAAM,iBAAa,aAAM;yBACzB,aAAM,kBAhDL,sBAgDqB;;kDAhDrB,IAiDQ,cAjDP;;kDAAD,AAiDW;;yBAjDX;;yBAoDD,aAAM,SApDL;;kDAqDG,4BArDH,MAAC,sBAqDwB;;wEArDvB;;kDAAD,AAuDU;;;;yBAIZ","sourcesContent":["// Dolittle\r\nalltimer=!create.\r\nalltimer:list=Array!create.\r\nalltimer:stop=[\r\n    self:list![|i|i!stop.]each.\r\n    self.\r\n].\r\n\r\nTimer=!create.\r\nTimer:i=100.\r\nTimer:t=100.\r\nTimer:interval=[|i|\r\n    [i>=0.001]![i=0.001]or.\r\n    self:i=i*1000.\r\n    self\r\n].\r\nTimer:times=[|t|self:t=t.self].\r\nTimer:duration=[|t|self:t=t*1000/self:i.self].\r\nTimer:d=:system!(:window:$:Deferred)new resolve.\r\nTimer:skip=[].\r\nTimer:abort=[].\r\nTimer ! \"abort\" \"stop\" addAlias.\r\nTimer:execute=[|f;s t i c|\r\n    s=self.\r\n    t=s:t.\r\n    i=s:i.\r\n    c=1.\r\n    :alltimer:list!(s)add.\r\n    s:d=s:d![|;d|\r\n        s:abort=[:window!(s:id)clearInterval].\r\n        s:skip=[:window!(s:id)clearInterval.d!resolve].\r\n        d=:system!(:window:$:Deferred)new.\r\n        s:id=(:window)![\r\n            [f!(c)execute.]!try[|e|\r\n                s!abort.\r\n                window ! \"\" \"\" \"\" \"\" (e) onerror.\r\n                //:system!(e)throw.\r\n            ]catch.\r\n            c=c+1.\r\n            [c>t]!then[\r\n                s!skip.\r\n            ]execute.\r\n        ] (i) setInterval.\r\n        d.\r\n    ]then.\r\n    self.\r\n].\r\nTimer:next_execute=Timer:execute.\r\nTimer:after_execute=[|f|\r\n    self:d![f!execute]then.\r\n    self.\r\n].\r\nTimer:wait=[\r\n    DtlPromise ! (self) [|succ|\r\n        ! [\r\n            succ! execute\r\n        ] after_execute \r\n    ] wait.\r\n].\r\nTimer ! \"after_execute\" \"execute_once\" addAlias. \r\n! \"Timer\" \"timer\" addAlias."]}