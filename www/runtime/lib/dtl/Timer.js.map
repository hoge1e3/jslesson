{"version":3,"sources":["/home/devel/devel/Turtle/Timer.dtl"],"names":[],"mappings":"aACC;CACA,gBAAS,SAAK;CACd,gBAAS,SAHR;;CAAA,IAIQ,iBAJP,sBAIc;;QAJd,AAIgB;;QAJjB;;CAQD;CACA,aAAM,MALgB;CAMtB,aAAM,MANgB;CAOtB,aAAM,aAXL,sBAWgB;;CAXf;;SAAD,AAYI,GAZJ;UAAC;;QAAD,AAYe,EAZf;;CAAA,IAaQ,OAbR,AAaU,EA4BJ;QAzCN;;CAgBD,aAAM,UAhBL,sBAgBa;;CAhBb,IAgBoB,MAhBpB,AAgBsB;QAhBtB;;CAiBD,aAAM,aAjBL,sBAiBgB;;CAjBhB,IAiBuB,QAjBvB,AAiByB,EAwBnB,QAzCN,IAiBqC;QAjBrC;;CAkBD,aAAM,MAAG,uBAAS,cAAO,KAAE;CAC3B,aAAM,SAnBL;;;CAoBD,aAAM,UApBL;;;CAqBD;CACA,aAAM,YAtBL,sBAsBe;;;;;;CAtBf,AAuBG,EAvBH;CAAA,AAwBG,EAxBH,AAwBK,CAAE;CAxBP,AAyBG,EAzBH,AAyBK,CAAE;CAzBP,AA0BG,EA1BH;CA2BI,gBAAS,iBA3Bb,AA2BmB;CA3BnB,AA4BG,CAAE,MA5BL,AA4BO,CAAE,cA5BR;;;CAAD,AA6BO,CAAE,UA7BP;;QA6Be,iCA7BjB,AA6ByB,CAAE;;CA7B3B,AA8BO,CAAE,SA9BP;;CA8Bc,iCA9BhB,AA8BwB,CAAE;QA9BzB,AA8B0C;;CA9B1C,AA+BM,EAAG,uBAAS,cAAO,KAAE;CA/B5B,AAgCO,CAAE,QAAK,+BAhCZ;;CAAC;;QAAH,AAiCY,cAjCZ,AAiCe;sBAjCZ,sBAiC6B;;CAjChC,AAkCe;QACA,uCAnCZ,AAmCkC;;CAnCrC,AAsCW,GAtCX,AAsCa,EAtCb;QAAG;;SAAH,AAuCY,EAvCZ,AAuCc;yBAvCX;;QAAH,AAwCe;;KAxCf,AA0CU;QA1CT,AA2CM;;QA3CP;;CA+CD,aAAM,iBAAa,aAAM;CACzB,aAAM,kBAhDL,sBAgDqB;;CAhDrB,IAiDQ,cAjDP;;QAAD,AAiDW;;QAjDX","sourcesContent":["// Dolittle\r\nalltimer=!create.\r\nalltimer:list=Array!create.\r\nalltimer:stop=[\r\n    self:list![|i|i!stop.]each.\r\n    self.\r\n].\r\n\r\nTimer=!create.\r\nTimer:i=100.\r\nTimer:t=100.\r\nTimer:interval=[|i|\r\n    [i>=0.001]![i=0.001]or.\r\n    self:i=i*1000.\r\n    self\r\n].\r\nTimer:times=[|t|self:t=t.self].\r\nTimer:duration=[|t|self:t=t*1000/self:i.self].\r\nTimer:d=:system!(:window:$:Deferred)new resolve.\r\nTimer:skip=[].\r\nTimer:abort=[].\r\nTimer ! \"abort\" \"stop\" addAlias.\r\nTimer:execute=[|f;s t i c|\r\n    s=self.\r\n    t=s:t.\r\n    i=s:i.\r\n    c=1.\r\n    :alltimer:list!(s)add.\r\n    s:d=s:d![|;d|\r\n        s:abort=[:window!(s:id)clearInterval].\r\n        s:skip=[:window!(s:id)clearInterval.d!resolve].\r\n        d=:system!(:window:$:Deferred)new.\r\n        s:id=(:window)![\r\n            [f!(c)execute.]!try[|e|\r\n                s!abort.\r\n                window ! \"\" \"\" \"\" \"\" (e) onerror.\r\n                //:system!(e)throw.\r\n            ]catch.\r\n            c=c+1.\r\n            [c>t]!then[\r\n                s!skip.\r\n            ]execute.\r\n        ] (i) setInterval.\r\n        d.\r\n    ]then.\r\n    self.\r\n].\r\nTimer:next_execute=Timer:execute.\r\nTimer:after_execute=[|f|\r\n    self:d![f!execute]then.\r\n    self.\r\n].\r\n! \"Timer\" \"timer\" addAlias."]}