<script src="jquery-2.1.0.js"></script>
<script src="lib.js"></script>
<script src="util.js"></script>
<script src="require.js"></script>
<pre id="console"></pre>
<script>
requirejs(["FS"],function(FS){
	$(function(){
		var args=location.search.slice(1).split("&");
		var param={};
		jQuery.each(args,function(){
			var tmp=this.split("=");
			param[tmp[0]]=tmp[1];
		});
		try{
			new Function(FS.get(param.file).text())();
			$.post("../../dump.php",{data:"RUN!\n"+$("#console").text()+"\nRUN END!"}).then(function (r) {
				console.log(r);
			}).fail(function(e){
				console.log(e);
			});
		}catch(e){
			alert(e);
			$.post("../../dump.php",{data:"RUNTIME ERROR!\n"+e+"\nRUNTIME ERROR END!"}).then(function (r) {
				console.log(r);
			}).fail(function(e){
				console.log(e);
			});
		}
	});
});
</script>
