<html>
<script src="jquery-2.1.0.js"></script>
<script src="parser.js"></script>
<script src="ExpressionParser2.js"></script>
<script src="ctrans.js"></script>
<script src="compiler.js"></script>
<script src="beautify.js"></script>
<script src="lib.js"></script>
<script src="require.js"></script>

<script>
requirejs(["FS"],function (FS) {
	$(function () {
		var userid="???";
		var classid="???";
	  var cFile=FS.get("/main.c");
		var jsFile=FS.get("/main.js");
		//var logFile=FS.get("/userid.log");
	  if (cFile.exists()) $("#prog").val(cFile.text());
		//if (logFile.exists()) logFile.text("classid\tuserid\ttime\terr\terrcode\tprogram\n");
	  $("#parse").click(function () {
			var log={userid:userid,classid:classid,time:(new Date).toLocaleString()}
			cFile.text($("#prog").val());
			compile(cFile,jsFile,log);
	   	$("#res").val(jsFile.text());
			console.log(/*logFile.text()+*/log.classid+"\t"+log.userid+"\t"+log.time+"\t"+log.err+"\t"+log.errcode+"\t"+log.program+"\n");
	  });
		$("#run").click(function(){$("#iframe").attr("src","./runc.html?file=/main.js");;});
	});
});
</script>

<textarea id=prog rows=10 cols=40>a=a;
int main(void){a=a;}</textarea><br>
<button id=parse>Parse</button>
<button id=run>Run</button>
<pre id=console></pre>
<form name="form"><textarea id=res rows=10 cols=40></textarea></form>
<iframe id="iframe" src="about:blank" width="640" height="480" style="position:absolute;left:300px;top:10px"><iframe>
</html>
